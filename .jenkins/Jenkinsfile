pipeline {
    agent any
    stages {
        stage('Build') {
           
               agent{
                docker{
                    image 'composer:2.7.1'
                    args '''
                    -v ./:/app
                    -w /app
                     bash
                    '''
                    reuseNode true
                }
            }
             steps {
                    echo "building .... "
                    sh '''
                        composer dump-env prod  
                     ''' 
            }
        }
        stage('Test') {
            steps {
                 echo "testing ... "
            }
        }
        stage('Deploy') {
            steps {
                 echo "deploying ... "
            }
        }
    }
}